<footer>
    <div style="margin-left: 7%; margin-right: 7%;">
       
      <div class="container" style="width: 100%;">
      
        <div class="row g-4">
           
          <!-- Logo and Counts -->
          <div class="col-lg-4">
           
            <a class="navbar-brand d-flex align-items-center me-3" href="index.php">
              <img src="ic_logo.svg" alt="logo" style="height: 68px;" />
            </a>
            <p class="mb-3">
              Craft, create, and inspire with endless design possibilities at
              Design Bundles.
            </p>
            <div class="footer-counts">
              <p><strong>500</strong> Products</p>
              <p><strong>212</strong> Customers</p>
            </div>
          </div>
  
          <div class="col-lg-2">
            <!-- Optional content or spacing -->
          </div>
          <!-- Navigation -->
          <div class="col-lg-2 footer-links text-end">
            <h6>Navigation</h6>
            <ul>
              <li><a href="cookie.php">Cookie Policy</a></li>
              <li><a href="privacy.php">Privacy Policy</a></li>
              <li><a href="terms.php">Terms and Conditions</a></li>
            </ul>
          </div>
  
          <!-- Resources -->
          <div class="col-lg-2 footer-links text-end" >
            <h6>Resources</h6>
            <ul>
              <li><a href="mailto:support@digitalsdesign.com">Help Center</a></li>
            </ul>
          </div>
  
          <!-- Pages -->
          <div class="col-lg-2 footer-links text-end">
            <h6>Pages</h6>
            <ul class="list-unstyled">
              <li><a href="login.php">Register</a></li>
              <li><a href="login.php">Login</a></li>
            </ul>
          </div>
          
  
          <!-- Right side spacing/badge area -->
         
        </div>
  
        <!-- Social & Currency -->
        <div class="row mt-4 align-items-center">
          <div class="col-md-6 text-center text-md-start social-icons">
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-pinterest-p"></i></a>
            <a href="#"><i class="fab fa-x-twitter"></i></a>
            <a href="#"><i class="fab fa-youtube"></i></a>
          </div>
          <div class="col-md-6 text-center text-md-end">
            <div class="dropdown d-inline-block"></div>
          </div>
        </div>
  
        <!-- Bottom Text -->
        <div class="footer-bottom text-center mt-4">
          <p class="mb-1">Â© 2025 - All rights reserved. Digtials Design</p>
          <p class="mb-0"></p>
        </div>
      </div>
    </div>
  </footer>
  
  
</body>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>


<!-- Your existing JavaScript code remains the same -->
<script>
 
$(function () {
  $.getJSON('ajax/get_categories.php', function (tree) {
    $('#category-nav').html(renderMegaMenu(tree));
  });
});
$(function() {
  // Show mega dropdown on hover
  $('#category-nav').on('mouseenter', '.dropdown-mega', function () {
    $(this).addClass('show');
    $(this).find('.mega-menu').addClass('show');
  });
  $('#category-nav').on('mouseleave', '.dropdown-mega', function () {
    $(this).removeClass('show');
    $(this).find('.mega-menu').removeClass('show');
  });
});
// Delegated category/subcategory handle; works for all levels

/*
$(document).on('click', '#category-nav .dropdown-item, #category-nav .nav-link', function (e) {
  e.preventDefault();
  let href = $(this).attr('href');
  let urlParams = new URLSearchParams(href.split('?')[1]);
  let catId = urlParams.get('category_id');
  if (catId) {
    currentCategory = catId;
    currentCategoryName = $(this).text().trim();
    $('#main-search-input').val('');
    $('#hero-section, #featured-section, #premium-section').hide();
    $('#search-results-section').show();
    $('#search-title').text('Category: ' + currentCategoryName);
    $('#clear-category-btn').show();
    fetchAndRenderSearch(true);
    searchMode = true;
  }
});*/





$(document).on('click', '#category-nav .dropdown-item, #category-nav .nav-link', function (e) {
  e.preventDefault();

  // Close ALL open mega menus/dropdowns
  $('.dropdown-mega, .mega-menu, .dropdown-menu').removeClass('show');

  let href = $(this).attr('href');
  let urlParams = new URLSearchParams((href || '').split('?')[1] || '');
  let catId = urlParams.get('category_id');

  if (catId) {
    currentCategory = catId;
    currentCategoryName = $(this).text().trim();
    $('#main-search-input').val('');
    $('#hero-section, #featured-section, #premium-section').hide();
    $('#search-results-section').show();
    $('#search-title').text('Category: ' + currentCategoryName);
    $('#clear-category-btn').show();
    fetchAndRenderSearch(true);
    searchMode = true;
    $('#clear-category-btn').focus();
    console.log('cat click ');
  }
});



</script>



<script>
  

 
  // When "X" clear button is clicked
  $('#clear-category-btn').on('click', function() {
    location.reload();
});



</script>
<script>
  $(function () {
      // Add to cart/wishlist AJAX
      $(document).on('click', '.wishlist-btn, .cart-btn', function () {
          var productId = $(this).closest('.overlay-buttons').data('product-id');
          var action = $(this).hasClass('wishlist-btn') ? 'add_to_wishlist' : 'add_to_cart';
  
          $.ajax({
              type: "POST",
              url: 'ajax/product_action.php',
              data: {
                  action: action,
                  product_id: productId,
                  url: 'index.php' // Current page URL
              },
              dataType: "json",
              success: function (resp) {
                  console.log('Response:', resp);
  
                  if (resp.success === '1') {
                      updateCartIconCount();
                      alert(resp.message || 'Added to cart successfully');
                      window.location.href = 'cart.php';
                  } else if (resp.success === '2') {
                      alert(resp.message || 'Added to wishlist successfully');
                      window.location.href = 'wishlist.php';
                  } else if (resp.success === 'login_required') {
                      alert(resp.message || 'Please log in to continue');
                      window.location.href = 'login.php';
                  } else {
                      console.log('Unhandled response:', resp);
                      alert(resp.message || 'Something went wrong');
                  }
              },
              error: function (xhr, status, error) {
                  let msg = "Unexpected error. ";
                  if (xhr.responseText) {
                      msg += "\nServer says: " + xhr.responseText;
                  }
                  alert(msg);
                  console.error('AJAX Error:', status, error, xhr.responseText);
              }
          });
      });
  
      // Initialize cart count on page load
      updateCartIconCount();
  });
  
  function updateCartIconCount() {
      $.getJSON('ajax/cart_get.php', function (items) {
          console.log('Cart items received:', items); // Debug log
          
          let count = 0;
          
          // Handle different response formats
          if (Array.isArray(items)) {
              count = items.length;
          } else if (items && typeof items === 'object') {
              // If items is an object with a count property
              if (items.count !== undefined) {
                  count = parseInt(items.count) || 0;
              } else if (items.items && Array.isArray(items.items)) {
                  count = items.items.length;
              } else {
                  // Count object properties
                  count = Object.keys(items).length;
              }
          } else if (typeof items === 'number') {
              count = items;
          }
  
          const badge = $('#cartCountBadge');
          
          // Update both mobile and desktop cart badges if they exist
          $('#cartCountBadge, #cartCountBadgeMobile').each(function() {
              $(this).text(count);
              
              if (count > 0) {
                  $(this).css('color', '#dc3545'); // Bootstrap Red
                  $(this).removeClass('d-none').show();
              } else {
                  $(this).css('color', '#aaa'); // Grey for 0
              }
          });
          
          console.log('Cart count updated to:', count); // Debug log
      }).fail(function(xhr, status, error) {
          console.error('Failed to load cart count:', error);
          // Set count to 0 if request fails
          $('#cartCountBadge, #cartCountBadgeMobile').text('0').css('color', '#aaa');
      });
  }
  
  // Also update cart count when page becomes visible (user switches tabs)
  $(document).on('visibilitychange', function() {
      if (!document.hidden) {
          updateCartIconCount();
      }
  });
  
  // Update cart count every 30 seconds (optional)
  setInterval(updateCartIconCount, 30000);
  </script>
  

<script>
  $(function () {
      // Load categories for both desktop and mobile
      $.getJSON('ajax/get_categories.php', function (tree) {
          // Desktop menu
          $('#category-nav').html(renderMegaMenu(tree));
          // Mobile menu
          $('#mobile-category-menu').html(renderMobileMenu(tree));
      });
  });

  // Desktop mega menu renderer (existing function)
  function renderMegaMenu(categories) {
      let html = '';
      categories.forEach(function (category) {
          if (category.children && category.children.length > 0) {
              html += `
              <li class="nav-item dropdown dropdown-mega">
                  <a class="nav-link dropdown-toggle" href="?category_id=${category.category_id}" id="navbarDropdown${category.category_id}" 
                     role="button" aria-expanded="false">
                    ${category.name}
                  </a>
                  <div class="dropdown-menu mega-menu" aria-labelledby="navbarDropdown${category.category_id}">
                    <div class="container">
                      <div class="row">
                        <div class="col-md-12">
                          <h6 class="dropdown-header">${category.name}</h6>
                          ${renderSubCategories(category.children)}
                        </div>
                      </div>
                    </div>
                  </div>
              </li>`;
          } else {
              html += `
              <li class="nav-item">
                  <a class="nav-link" href="?category_id=${category.category_id}">
                    ${category.name}
                  </a>
              </li>`;
          }
      });
      return html;
  }

  function renderSubCategories(subcategories) {
      let html = '<div class="row">';
      subcategories.forEach(function (subcategory) {
          html += `
          <div class="col-md-6 mb-2">
            <a class="dropdown-item" href="?category_id=${subcategory.category_id}">
              <i class="bi bi-arrow-right-short"></i> ${subcategory.name}
            </a>
          </div>`;
      });
      html += '</div>';
      return html;
  }

  // Mobile menu renderer
  /*
  function renderMobileMenu(categories) {
      let html = '';
      categories.forEach(function (category) {
          if (category.children && category.children.length > 0) {
              html += `
              <div class="mobile-category-item">
                  <a href="#" class="mobile-category-link" data-category-id="${category.category_id}" 
                     onclick="toggleMobileSubmenu(this, event)">
                      <span>${category.name}</span>
                      <i class="fas fa-chevron-down mobile-category-icon"></i>
                  </a>
                  <div class="mobile-subcategory-list">
                      ${renderMobileSubCategories(category.children)}
                  </div>
              </div>`;
          } else {
              html += `
              <div class="mobile-category-item">
                  <a href="?category_id=${category.category_id}" class="mobile-category-link mobile-category-direct">
                      <span>${category.name}</span>
                  </a>
              </div>`;
          }
      });
      return html;
  }*/
  function renderMobileMenu(categories) {
    let html = '';
    categories.forEach(function (category) {
      if (category.children && category.children.length > 0) {
        html += `
            <div class="mobile-category-item">
                <a href="#" class="mobile-category-link" data-category-id="${category.category_id}" data-has-submenu="true">
                    <span>${category.name}</span>
                    <i class="fas fa-chevron-down mobile-category-icon"></i>
                </a>
                <div class="mobile-subcategory-list">
                    ${renderMobileSubCategories(category.children)}
                </div>
            </div>`;
      } else {
        html += `
            <div class="mobile-category-item">
                <a href="?category_id=${category.category_id}" class="mobile-category-link mobile-category-direct" data-category-id="${category.category_id}">
                    <span>${category.name}</span>
                </a>
            </div>`;
      }
    });
    return html;
  }

  function renderMobileSubCategories(subcategories) {
      let html = '';
      subcategories.forEach(function (subcategory) {
          html += `
          <div class="mobile-subcategory-item">
              <a href="?category_id=${subcategory.category_id}" class="mobile-subcategory-link">
                  ${subcategory.name}
              </a>
          </div>`;
      });
      return html;
  }

  // Toggle mobile submenu
 // Updated toggle function with proper event handling
function toggleMobileSubmenu(element, event) {
    event.preventDefault();
    event.stopPropagation(); // Prevent event bubbling
    event.stopImmediatePropagation(); // Stop all event propagation
    
    const $item = $(element).closest('.mobile-category-item');
    const $submenu = $item.find('.mobile-subcategory-list');
    
    // Close other open submenus
    $('.mobile-category-item').not($item).removeClass('show');
    $('.mobile-subcategory-list').not($submenu).slideUp(200);
    
    // Toggle current submenu
    $item.toggleClass('show');
    $submenu.slideToggle(200);
}

// Updated mobile category click handler
// Fixed mobile category click handler
$(document).on('click', '.mobile-category-link', function(e) {
    const $submenu = $(this).next('.mobile-subcategory-list');
    
    if ($submenu.length > 0) {
        // Has subcategories - toggle submenu
        e.preventDefault();
        e.stopPropagation();
        
        const $item = $(this).closest('.mobile-category-item');
        const isCurrentlyOpen = $item.hasClass('show');
        
        // Close all other open submenus first
        $('.mobile-category-item').not($item).removeClass('show');
        $('.mobile-subcategory-list').not($submenu).slideUp(200);
        
        // Toggle current submenu
        if (isCurrentlyOpen) {
            $item.removeClass('show');
            $submenu.slideUp(200);
        } else {
            $item.addClass('show');
            $submenu.slideDown(200);
        }
    } else {
        // No subcategories - treat as direct category link
        $(this).addClass('mobile-category-direct');
        // Let the main category handler process this
    }
});

// Allow clicking outside menu to close all submenus
$(document).on('click touchstart', function(e) {
    // Close submenus if clicking outside the entire offcanvas menu
    if (!$(e.target).closest('#mobileMenuOffcanvas').length) {
        $('.mobile-category-item').removeClass('show');
        $('.mobile-subcategory-list').slideUp(200);
    }
});

// Close submenus when offcanvas is being hidden
document.addEventListener('DOMContentLoaded', function() {
    const offcanvasElement = document.getElementById('mobileMenuOffcanvas');
    if (offcanvasElement) {
        offcanvasElement.addEventListener('hide.bs.offcanvas', function () {
            $('.mobile-category-item').removeClass('show');
            $('.mobile-subcategory-list').slideUp(200);
        });
    }
});


  // Handle category clicks
// Update the mobile category click handler
// Updated mobile category click handler with scroll fix
$(document).on('click', '.mobile-category-direct, .mobile-subcategory-link', function (e) {
    e.preventDefault();
    e.stopPropagation();
    
    // Remove any active/focus states
    $(this).blur();
    
    // Store scroll position before closing menu
    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
    
    // Close the offcanvas menu
    const offcanvasElement = document.getElementById('mobileMenuOffcanvas');
    const offcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);
    if (offcanvas) {
        offcanvas.hide();
    }
    
    // Force cleanup after menu closes
    setTimeout(() => {
        // Remove any backdrop manually
        $('.offcanvas-backdrop').remove();
        
        // Restore body scroll
        $('body').removeClass('modal-open offcanvas-open')
                 .css({
                     'overflow': 'auto',
                     'position': 'static',
                     'padding-right': '0',
                     'height': 'auto'
                 });
        
        // Restore scroll position
        window.scrollTo(0, scrollTop);
        
        // Force repaint
        document.body.style.display = 'none';
        document.body.offsetHeight; // Trigger reflow
        document.body.style.display = '';
        
    }, 100);
    
    // Handle the category selection
    let href = $(this).attr('href');
    let urlParams = new URLSearchParams((href || '').split('?')[1] || '');
    let catId = urlParams.get('category_id');

    if (catId) {
        currentCategory = catId;
        currentCategoryName = $(this).text().trim();
        $('#main-search-input, #main-search-input-mobile').val('');
        $('#hero-section, #featured-section, #premium-section').hide();
        $('#search-results-section').show();
        $('#search-title').text('Category: ' + currentCategoryName);
        $('#clear-category-btn').show();
        fetchAndRenderSearch(true);
        searchMode = true;
        
        // Ensure page is scrollable after content loads
        setTimeout(() => {
            $('body, html').css('overflow', 'auto');
            // Scroll to top of results
            $('html, body').animate({ scrollTop: 0 }, 300);
        }, 200);
    }
});

// Also fix the offcanvas event listeners
document.addEventListener('DOMContentLoaded', function() {
    const offcanvasElement = document.getElementById('mobileMenuOffcanvas');
    if (offcanvasElement) {
        // Initialize with proper settings
        const offcanvas = new bootstrap.Offcanvas(offcanvasElement, {
            backdrop: false,
            keyboard: true,
            scroll: true
        });
        
        // Fix scroll when offcanvas is hidden
        offcanvasElement.addEventListener('hidden.bs.offcanvas', function () {
            // Force restore scrolling
            $('body, html').css({
                'overflow': 'auto',
                'position': 'static',
                'padding-right': '0'
            });
            
            // Remove any lingering classes
            $('body').removeClass('modal-open offcanvas-open');
            
            // Force focus back to body
            $('body').focus();
        });
        
        // Prevent scroll lock when showing
        offcanvasElement.addEventListener('show.bs.offcanvas', function () {
            $('body').css('overflow', 'auto');
        });
    }
});

  // Desktop hover functionality
  $(function () {
      $('#category-nav').on('mouseenter', '.dropdown-mega', function () {
          $(this).addClass('show');
          $(this).find('.mega-menu').addClass('show');
      });
      $('#category-nav').on('mouseleave', '.dropdown-mega', function () {
          $(this).removeClass('show');
          $(this).find('.mega-menu').removeClass('show');
      });
  });

  // Handle desktop category clicks
  $(document).on('click', '#category-nav .dropdown-item, #category-nav .nav-link', function (e) {
      e.preventDefault();
      $('.dropdown-mega, .mega-menu, .dropdown-menu').removeClass('show');

      let href = $(this).attr('href');
      let urlParams = new URLSearchParams((href || '').split('?')[1] || '');
      let catId = urlParams.get('category_id');

      if (catId) {
          currentCategory = catId;
          currentCategoryName = $(this).text().trim();
          $('#main-search-input, #main-search-input-mobile').val('');
          $('#hero-section, #featured-section, #premium-section').hide();
          $('#search-results-section').show();
          $('#search-title').text('Category: ' + currentCategoryName);
          $('#clear-category-btn').show();
          fetchAndRenderSearch(true);
          searchMode = true;
      }
  });

  // Ensure mobile menu loads when offcanvas is shown
  document.getElementById('mobileMenuOffcanvas').addEventListener('shown.bs.offcanvas', function () {
      // If categories haven't loaded yet, load them
      if ($('#mobile-category-menu').children().length === 0) {
          $.getJSON('ajax/get_categories.php', function (tree) {
              $('#mobile-category-menu').html(renderMobileMenu(tree));
          });
      }
  });

  // Fix for category loading - make sure this runs after DOM is ready
  $(document).ready(function () {
      // Load categories immediately
      $.getJSON('ajax/get_categories.php', function (tree) {
          // Desktop menu
          $('#category-nav').html(renderMegaMenu(tree));
          // Mobile menu
          $('#mobile-category-menu').html(renderMobileMenu(tree));
      }).fail(function () {
          console.error('Failed to load categories');
          // Fallback static menu for testing
          $('#mobile-category-menu').html(`
      <div class="mobile-category-item">
          <a href="#" class="mobile-category-link">
              <span>Sample Category</span>
          </a>
      </div>
  `);
      });
  });

</script>

<script>
  // Ensure Bootstrap dropdowns are initialized
  $(document).ready(function() {
      // Initialize all dropdowns
      var dropdownElementList = [].slice.call(document.querySelectorAll('.dropdown-toggle'));
      var dropdownList = dropdownElementList.map(function (dropdownToggleEl) {
          return new bootstrap.Dropdown(dropdownToggleEl);
      });
      
      // Debug: Check if dropdowns are working
      $('.dropdown-toggle').on('click', function(e) {
          console.log('Dropdown clicked:', this.id);
      });
      
      // Alternative: Manual dropdown toggle if Bootstrap doesn't work
      $('.dropdown-toggle').on('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          
          // Close other dropdowns
          $('.dropdown-menu').not($(this).next()).removeClass('show');
          
          // Toggle current dropdown
          $(this).next('.dropdown-menu').toggleClass('show');
      });
      
      // Close dropdown when clicking outside
      $(document).on('click', function(e) {
          if (!$(e.target).closest('.dropdown').length) {
              $('.dropdown-menu').removeClass('show');
          }
      });
  });

  // Updated offcanvas handlers
document.addEventListener('DOMContentLoaded', function() {
    const offcanvasElement = document.getElementById('mobileMenuOffcanvas');
    if (offcanvasElement) {
        const offcanvas = new bootstrap.Offcanvas(offcanvasElement, {
            backdrop: false,
            keyboard: true,
            scroll: true
        });
        
        // Don't close submenu when offcanvas events fire
        offcanvasElement.addEventListener('hide.bs.offcanvas', function (e) {
            // Only close if not clicking on submenu elements
            if ($(e.target).closest('.mobile-subcategory-list, .mobile-category-link').length === 0) {
                $('.mobile-category-item').removeClass('show');
                $('.mobile-subcategory-list').slideUp(200);
            }
        });
    }
});

// Prevent document click from closing submenus unless clicking outside menu
$(document).on('click touchstart', function(e) {
    // Only close submenus if clicking completely outside the offcanvas
    if (!$(e.target).closest('#mobileMenuOffcanvas').length) {
        $('.mobile-category-item').removeClass('show');
        $('.mobile-subcategory-list').slideUp(200);
    }
});

  </script>
  
</body>
</html>
